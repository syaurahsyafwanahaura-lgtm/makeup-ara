<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Instaperfect Store</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; font-family:'Quicksand',sans-serif; }
body{margin:0; background:#000; color:white;}
h2,h3,h4{margin:0;font-family:'Cormorant Garamond',serif;}
button{cursor:pointer; transition:0.2s;}
button:hover{transform:scale(1.05);}

/* ===== HEADER ===== */
header{
  display:flex; justify-content:space-between; align-items:center;
  padding:15px 30px; background:#800000; font-family:'Cormorant Garamond',serif; font-size:26px; font-weight:600;
}
.header-right{display:flex;align-items:center;gap:12px}
.account{cursor:pointer;padding:6px;border-radius:8px}
.account:hover{background:rgba(255,255,255,0.03)}

/* ===== HOME PAGE ===== */
.container{display:flex; height:calc(100vh - 70px);}
.kiri{width:20%; background:#330000; padding:15px; border-right:2px solid #800000;}
.kiri button{width:100%; margin-bottom:10px; padding:12px; border:none; border-radius:10px; background:#800000; color:white; font-weight:600;}
.kiri button:hover{background:#B22222;}
.tengah{width:60%; padding:10px; display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); gap:15px; overflow-y:auto;}
.card{background:#111; padding:10px; border-radius:15px; text-align:center; box-shadow:0 5px 15px rgba(255,0,0,0.2); transition:0.3s; cursor:pointer;}
.card:hover{transform:translateY(-5px);}
.card img{width:100%; border-radius:12px;}
.card button{background:#800000; border:none; color:white; margin-top:8px; padding:8px; border-radius:8px; font-weight:600;}
.shade{display:flex; justify-content:center; margin-top:5px;}
.shade div{width:20px;height:20px;margin:0 3px;border-radius:50%;border:1px solid #aaa; cursor:pointer; transition:0.2s;}
.shade div:hover{transform:scale(1.2);}
.kanan{width:20%; background:#330000; padding:10px; overflow-y:auto; border-left:2px solid #800000;}
.cart-item{display:flex; margin-bottom:8px; border-bottom:1px solid #B22222; padding-bottom:4px; align-items:center;}
.cart-item img{width:50px;height:50px;border-radius:8px;margin-right:10px;}
.cart-item-details{flex:1;}
.cart-item button{background:red;color:white;border:none;cursor:pointer;border-radius:5px;padding:2px 5px;}
.payment{margin-top:15px;padding-top:10px;border-top:2px solid #B22222;}
.payment select{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:none;}
.payment button{width:100%;margin-top:10px;padding:10px;border:none;border-radius:8px;background:#800000;color:white;font-weight:600;}

/* ===== MODAL LOGIN / SIGNUP (hidden by default) ===== */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
  z-index:1000;
}
.modal-box{
  background:#111; padding:22px; border-radius:12px; width:92%; max-width:380px; text-align:center;
  box-shadow:0 10px 30px rgba(0,0,0,0.7);
}
.modal-box h3{color:#D9917F;margin-bottom:12px}
.modal-box input{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:none;background:#222;color:white}
.modal-box .row{display:flex;gap:8px}
.modal-box .small{flex:1;padding:10px;border-radius:8px;border:none;background:#333;color:white}

/* ===== MODAL DETAIL ===== */
#modalDetail{
  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.8); justify-content:center; align-items:center;
  overflow:auto; padding:20px; z-index:900;
}
#modalContent{
  background:#111; padding:20px; border-radius:15px; width:90%; max-width:520px;
  position:relative; max-height:90vh; overflow-y:auto;
}
#modalContent img{width:100%; border-radius:12px; margin-bottom:10px;}
#modalContent .close, #modalContent .backBtn{
  position:absolute; top:10px; font-size:18px; cursor:pointer; color:#D9917F;
  background:rgba(0,0,0,0.3); border:none; padding:5px 10px; border-radius:8px;
}
#modalContent .close{right:10px;}
#modalContent .backBtn{left:10px;}
#modalContent h3{margin-top:0;}
#modalContent .shade{margin-bottom:10px;}

/* RESPONSIVE */
@media(max-width:900px){
  .container{
    flex-direction:row;
  }
  .kiri{
    width:25%;
  }
  .tengah{
    width:50%;
  }
  .kanan{
    width:25%;
  }
}
@media(max-width:900px){
  .container{
    flex-direction:row;
  }
  .kiri{
    width:25%;
  }
  .tengah{
    width:50%;
  }
  .kanan{
    width:25%;
  }
}
@media(max-width:900px){
  .container{
    flex-direction:row;
  }
  .kiri{
    width:25%;
  }
  .tengah{
    width:50%;
  }
  .kanan{
    width:25%;
  }
}
/* ===== CHAT MODAL ===== */
#chatModal{
  display:none;
  position:fixed;
  bottom:20px;
  right:20px;
  width:350px;
  height:500px;
  background:#111;
  border-radius:12px;
  box-shadow:0 5px 15px rgba(0,0,0,0.7);
  z-index:1000;
  display:flex;
  flex-direction:column;
}
.chat-header{
  background:#800000;
  padding:10px;
  border-radius:12px 12px 0 0;
  color:white;
  font-weight:600;
}
.chat-body{
  flex:1;
  padding:10px;
  overflow-y:auto;
  background:#222;
}
.chat-message{
  margin-bottom:10px;
  padding:8px;
  border-radius:8px;
  font-size:13px;
}
.chat-user{
  background:#800000;
  color:white;
  text-align:right;
}
.chat-bot{
  background:#333;
  color:white;
}
.chat-footer{
  padding:10px;
  border-top:1px solid #444;
}
.chat-input{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:none;
  background:#333;
  color:white;
}
.quick-questions{
  display:flex;
  flex-wrap:wrap;
  gap:5px;
  margin-bottom:5px;
}
.quick-questions button{
  background:#800000;
  color:white;
  border:none;
  padding:5px 8px;
  border-radius:5px;
  font-size:12px;
  cursor:pointer;
}
.quick-questions button:hover{
  background:#B22222;
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div>INSTAPERFECT</div>
  <div class="header-right">
    <div class="header-right">
  <div class="account" title="Akun" onclick="openAuthModal()">ðŸ‘¤</div>
  <div class="cart" title="Keranjang" onclick="toggleCart()">ðŸ›’<span id="cartCount">0</span></div>
  <div class="chat" title="Chat Admin" onclick="openChatModal()">ðŸ’¬</div>
</div>

</header>

<!-- MAIN LAYOUT -->
<div class="container">
  <div class="kiri">
    <h4>Kategori</h4>
    <button onclick="filter('all')">All</button>
    <button onclick="filter('muka')">Face</button>
    <button onclick="filter('bibir')">Lip</button>
    <button onclick="filter('mata')">Eye</button>
  </div>

  <div class="tengah" id="produk"></div>

  <div class="kanan" id="kananPanel">
    <h4>Keranjang</h4>
    <div id="cartBox"></div>
    <div class="payment">
      <h4>Pembayaran & Ongkir</h4>
      <select id="method">
        <option value="COD">Cash on Delivery</option>
        <option value="Transfer">Transfer Bank</option>
        <option value="E-Wallet">E-Wallet</option>
      </select>
      <p id="ongkirDisplay">Ongkir: Rp0</p>
      <p id="total">Total: Rp0</p>
      <button onclick="checkout()">Checkout</button>
    </div>
  </div>
</div>

<!-- AUTH MODAL (login + signup in same modal) -->
<div class="modal" id="authModal">
  <div class="modal-box" id="authBox">
    <h3 id="authTitle">Login</h3>

    <!-- LOGIN FIELDS -->
    <div id="loginFields">
      <input id="loginUsername" placeholder="Username">
      <input id="loginPassword" type="password" placeholder="Password">
      <div class="row">
        <button class="small" onclick="doLogin()">Login</button>
        <button class="small" onclick="switchToSignup()">Sign Up</button>
      </div>
      <p style="font-size:13px;margin-top:8px;color:#bbb">Atau daftar jika belum punya akun.</p>
    </div>

    <!-- SIGNUP FIELDS -->
    <div id="signupFields" style="display:none">
      <input id="signupUsername" placeholder="Username">
      <input id="signupPassword" type="password" placeholder="Password">
      <input id="signupPassword2" type="password" placeholder="Konfirmasi Password">
      <div class="row">
        <button class="small" onclick="doSignup()">Daftar</button>
        <button class="small" onclick="switchToLogin()">Batal</button>
      </div>
    </div>

    <p style="font-size:12px;color:#888;margin-top:10px">(Login wajib untuk menambahkan ke keranjang / checkout)</p>
  </div>
</div>

<!-- MODAL DETAIL -->
<div id="modalDetail">
  <div id="modalContent">
    <button class="backBtn" onclick="closeModal()">Kembali</button>
    <span class="close" onclick="closeModal()">Ã—</span>
    <img id="modalImg" src="">
    <h3 id="modalName"></h3>
    <p id="modalDesc"></p>
    <p id="modalPrice"></p>
    <div class="shade" id="modalShade"></div>
    <div style="display:flex;gap:8px;margin-top:10px;">
      <button id="modalAdd" onclick="">Tambah ke Keranjang</button>
      <button onclick="instantBuy()">Beli Sekarang</button>
    </div>
  </div>
</div>

<script>
// --- USERS / AUTH ---
let users = JSON.parse(localStorage.getItem("users")||"[]"); // stored as [{username, password},...]
let currentUser = null; // null = not logged in

// --- CART & PRODUCTS ---
let keranjang = [];

let produkData=[
  {n:"Instaperfect Mineralight Matte BB Cushion",k:"muka",harga:177000,img:"cushion.png",desc:"BB Cushion pertama dengan skin care benefit yang memberikan hasil healthy looking skin. Mengadung aktif mineral, yaitu Mineralight fix yang mampu menjaga kelembaban dan memberikan efek radian matte. Formula yang optimal mampu melindungi kulit dari sinar UV dengan SPF 50 PA++++ dan tahan hingga 12 jam.",shades:["#FBE2D0","#EAC4B7","#D8A39D"]},
  {n:"Instaperfect Porefection Skin Primer",k:"muka",harga:150000,img:"primer.png",desc:"Primer ringan dan breathable."},
  {n:"Instaperfect Everlast Intense Matte Liquid",k:"bibir",harga:99000,img:"lip matte.png",desc:"Lip cream dengan tekstur yang halus & lembut ketika di oles di bibir, serta tidak lengket sehingga nyaman digunakan. Terdiri dari 8 warna intense dengan hasil akhir matte, yang tahan lama hingga 12 jam.",shades:["#FFB3B3","#FF7F7F","#FF4C4C"]},
  {n:"Instaperfect Mattetitude Matte Stain Lipstick",k:"bibir",harga:85000,img:"lipstick matte.png",desc:"Lipstick yang memberikan tampilan supreme matte dan memberikan instant stain color. Long-lasting, tahan lama hingga 10 jam pemakaian. Memiliki tekstur creamy-to-powdery dan terasa ringan di bibir.",shades:["#FFA8A8","#FF7F7F","#FF5555"]},
  {n:"Instaperfect Browfessional 3D Brow Mascara",k:"mata",harga:110000,img:"mascara.png",desc:"Wardah Instaperfect Browfessional 3D Brow Mascara merupakan produk eyebrow dengan aplikator mascara yang didesain khusus untuk hasil presisi. Memiliki warna yang intense namun dapat diatur untuk hasil natural, dengan cepat menjadikan alis lebih berisi dan rapi (quickfix). Formula khususnya menjadikan produk ini tahan lama, smudgeproof, dan waterproof..",shades:["#000000","#2E2E2E","#4C4C4C"]},
  {n:"Instaperfect Spotlight Chromatic Eye Palette",k:"mata",harga:95000,img:"pallet.png",desc:"10 warna eye shadow dalam 1 palette dengan hasil intense buildable. Mineral-infused pigment menghasilkan warna-warna eye shadow cantik yang mampu menghasilkan berbagai macam kebutuhan tampilan makeup (versatile look).",}
];

// --- RENDER PRODUCTS (home displayed by default) ---
function tampil(k="all"){
  const box = document.getElementById("produk");
  box.innerHTML = "";
  produkData.filter(p=>k=="all"||p.k==k).forEach((p,i)=>{
    let shadeHTML = p.shades? p.shades.map(s=>`<div style="background:${s}"></div>`).join("") : "";
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<img src="${p.img}" alt="${p.n}">
      <h4>${p.n}</h4>
      <p>Rp${p.harga.toLocaleString()}</p>
      <div class="shade">${shadeHTML}</div>
      <button onclick="showDetail(${i})">Lihat Detail</button>`;
    box.appendChild(div);
  });
}
tampil();

// --- DETAIL MODAL ---
function showDetail(i){
  const p = produkData[i];
  document.getElementById("modalImg").src = p.img;
  document.getElementById("modalName").innerText = p.n;
  document.getElementById("modalDesc").innerText = p.desc;
  document.getElementById("modalPrice").innerText = `Rp${p.harga.toLocaleString()}`;
  const shadeHTML = p.shades? p.shades.map(s=>`<div style="background:${s}"></div>`).join("") : "";
  document.getElementById("modalShade").innerHTML = shadeHTML;
  // modalAdd needs to require login before adding
  document.getElementById("modalAdd").onclick = function(){ tryAddToCart(i) };
  document.getElementById("modalDetail").style.display = "flex";
}
function closeModal(){ document.getElementById("modalDetail").style.display = "none"; }

// --- AUTH MODAL CONTROLS ---
function openAuthModal(){ document.getElementById("authModal").style.display = "flex"; showLoginFields(); }
function closeAuthModal(){ document.getElementById("authModal").style.display = "none"; }

function showLoginFields(){
  document.getElementById("authTitle").innerText = "Login";
  document.getElementById("loginFields").style.display = "block";
  document.getElementById("signupFields").style.display = "none";
}
function switchToSignup(){
  document.getElementById("authTitle").innerText = "Sign Up";
  document.getElementById("loginFields").style.display = "none";
  document.getElementById("signupFields").style.display = "block";
}
function switchToLogin(){ showLoginFields(); }

// --- AUTH LOGIC ---
function doSignup(){
  const u = document.getElementById("signupUsername").value.trim();
  const p = document.getElementById("signupPassword").value;
  const p2 = document.getElementById("signupPassword2").value;
  if(!u || !p || !p2){ alert("Isi semua kolom!"); return; }
  if(p !== p2){ alert("Password tidak sama!"); return; }
  if(users.find(x=>x.username===u)){ alert("Username sudah ada!"); return; }
  users.push({username:u,password:p});
  localStorage.setItem("users", JSON.stringify(users));
  alert("Daftar berhasil! Silakan login.");
  switchToLogin();
}

function doLogin(){
  const u = document.getElementById("loginUsername").value.trim();
  const p = document.getElementById("loginPassword").value;
  if(!u || !p){ alert("Isi username & password!"); return; }
  const found = users.find(x=>x.username===u && x.password===p);
  if(!found){ alert("Akun tidak ditemukan!"); return; }
  currentUser = found;
  closeAuthModal();
  alert("Login berhasil!");
  // if there was a pending action that triggered login (like attempted add), it will continue by user action
}

// --- CART: add only if logged in (per request) ---
function tryAddToCart(index){
  if(!currentUser){
    // show auth modal and inform user
    openAuthModal();
    alert("Silakan login / daftar dulu untuk menambahkan ke keranjang.");
    return;
  }
  // logged in: add
  tambah(index);
  closeModal();
}

function tambah(i){
  keranjang.push(produkData[i]);
  updateCart();
}

function hapus(i){ keranjang.splice(i,1); updateCart(); }

function updateCart(){
  const box = document.getElementById("cartBox");
  const count = document.getElementById("cartCount");
  box.innerHTML = ""; let total = 0;
  keranjang.forEach((p,i)=>{
    box.innerHTML += `<div class="cart-item">
      <img src="${p.img}">
      <div class="cart-item-details">
        <strong>${p.n}</strong>
        <p>Rp${p.harga.toLocaleString()}</p>
      </div>
      <button onclick="hapus(${i})">X</button>
    </div>`;
    total += p.harga;
  });
  count.innerText = keranjang.length;
  const ongkir = Math.round(total * 0.1);
  document.getElementById("ongkirDisplay").innerText = `Ongkir: Rp${ongkir.toLocaleString()}`;
  total += ongkir;
  document.getElementById("total").innerText = `Total: Rp${total.toLocaleString()}`;
}

// --- CHECKOUT: requires login ---
function checkout(){
  if(!currentUser){
    openAuthModal();
    alert("Silakan login / daftar dulu untuk melakukan checkout.");
    return;
  }
  if(keranjang.length === 0){ alert("Keranjang kosong!"); return; }
  alert(`Checkout Berhasil!\nMetode: ${document.getElementById("method").value}\nTotal: ${document.getElementById("total").innerText}\nItems: ${keranjang.map(p=>p.n).join(", ")}`);
  keranjang = []; updateCart();
}

// --- instant buy from detail (requires login) ---
function instantBuy(){
  // get product shown in modal
  const name = document.getElementById("modalName").innerText;
  const product = produkData.find(p=>p.n === name);
  if(!product) return alert("Produk tidak tersedia.");
  if(!currentUser){
    openAuthModal();
    alert("Silakan login / daftar dulu untuk membeli.");
    return;
  }
  const ongkir = Math.round(product.harga * 0.1);
  const total = product.harga + ongkir;
  alert(`Checkout Langsung Berhasil!\nProduk: ${product.n}\nHarga: Rp${product.harga.toLocaleString()}\nOngkir: Rp${ongkir.toLocaleString()}\nTOTAL: Rp${total.toLocaleString()}\nMetode: ${document.getElementById("method").value}`);
  closeModal();
}

// --- UI HELPERS ---
function toggleCart(){
  const kanan = document.getElementById("kananPanel");
  kanan.style.display = kanan.style.display === "none" ? "block" : "none";
}
function filter(k){ tampil(k); }

// expose some functions for inline HTML use
window.filter = filter;
window.showDetail = showDetail;
window.tambah = tambah;
window.toggleCart = toggleCart;
window.checkout = checkout;
window.openAuthModal = openAuthModal;
window.instantBuy = instantBuy;
window.closeModal = closeModal;
window.tryAddToCart = tryAddToCart;
window.switchToSignup = switchToSignup;

window.switchToLogin = switchToLogin;
window.doSignup = doSignup;
window.doLogin = doLogin;

document.addEventListener('DOMContentLoaded',()=>{

});


function openChatModal(){
  const chat = document.getElementById("chatModal");
  chat.style.display = chat.style.display === "flex" ? "none" : "flex";
}

function sendMessage(){
  const input = document.getElementById("chatInput");
  const text = input.value.trim();
  if(!text) return;

  addChatMessage(text,"user");
  input.value = "";

  setTimeout(()=>{
    autoReply(text);
  },600);
}

function handleKeyPress(e){
  if(e.key === "Enter"){
    sendMessage();
  }
}

function sendQuickQuestion(text){
  addChatMessage(text,"user");
  setTimeout(()=>{
    autoReply(text);
  },600);
}

function addChatMessage(text,type){
  const body = document.getElementById("chatBody");
  const div = document.createElement("div");
  div.className = "chat-message " + (type==="user"?"chat-user":"chat-bot");
  div.innerText = text;
  body.appendChild(div);
  body.scrollTop = body.scrollHeight;
}

function autoReply(text){
  let reply = "Terima kasih, pesan Anda akan segera dijawab admin.";

  if(text.toLowerCase().includes("produk")){
    reply = "Produk terbaru kami tersedia di bagian Eye & Lip!";
  } 
  else if(text.toLowerCase().includes("pesan")){
    reply = "Pilih produk â†’ Login â†’ Tambah ke keranjang â†’ Checkout.";
  }
  else if(text.toLowerCase().includes("stok")){
    reply = "Sebagian besar produk masih tersedia hari ini.";
  }
  else if(text.toLowerCase().includes("kirim")){
    reply = "Kami melayani pengiriman ke seluruh Indonesia.";
  }

  addChatMessage(reply,"bot");
}


window.openChatModal = openChatModal;
window.sendQuickQuestion = sendQuickQuestion;
window.handleKeyPress = handleKeyPress;

</script>



<div id="chatModal">
  <div class="chat-header">Chat Admin</div>
  <div class="chat-body" id="chatBody">
    <div class="chat-message chat-bot">
      Halo! Saya admin Instaperfect. Ada yang bisa saya bantu? Pilih pertanyaan cepat atau tanyakan langsung.
    </div>
  </div>
  <div class="chat-footer">
    <div class="quick-questions">
      <button onclick="sendQuickQuestion('Apa produk terbaru?')">Produk Terbaru</button>
      <button onclick="sendQuickQuestion('Cara pesan?')">Cara Pesan</button>
      <button onclick="sendQuickQuestion('Stok produk apa saja?')">Cek Stok</button>
      <button onclick="sendQuickQuestion('Pengiriman ke mana saja?')">Pengiriman</button>
    </div>
</body>
</html>
